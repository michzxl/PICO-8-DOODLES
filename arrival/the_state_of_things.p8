pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--the state of things
--by ???

function _init()
	pal({
		[0]=0,7,--black/white
		2,8+128,
		13+128,13,--lavender
		1,12+128,--blue
		3+128,3,--green
		135,142,--yellow/orange
		8+128,8,--red
		6,7,--white/gray
	},1)

	period=4
	t=-1

	cls()

	pattern_i=1
	patterns={
		pattern0,
		pattern1,
		pattern2,
	}
	pattern=patterns[pattern_i]
end

function _update()
	t+=1/60

	if (t+3)%(period/2)<=1/60 then
		if rnd(1)<0.33 then
			for i=1,rnd(5) do
				pattern_i=pattern_i%#patterns+1
			end
		else
			pattern_i=1
		end
		pattern=patterns[pattern_i]
	end

	ct4,st2=cos(t/period),sin(t/(period/2))
	st16=sin(t/16)
	st8=sin(t/8)

	smpl=1300*abs(ct4)
	for i=1,smpl do pattern() end

	-- point where xo,yo=0,0
	circfill(32*st2+64, 32*ct4+64, 2, t*16%15+1)
end

function pattern0()
	-- distribution of xo,yo is a uniform rectangle.
	xo=rnd(80) - 64 -- [-64,16]
	yo=rnd(150) - 75 -- [-75,75]

	-- rotate & scale x,y
	x=(xo+32)*st2 - yo*ct4
	y=(xo+32)*ct4 + yo*st2

	c = -st8 * x/16
	+ cos(x/64 - t/2) * y/32
	+ (xo/32 + yo/32 + y)/(st16*4+12)
	+ t
	
	c=flr(c%2)--{0,1}
	c+=fflr(t+1,period/2)--{k,k+1}
	
	circ(x+64,y+64,1,c)
end

function pattern1()
	xo=rnd(80) - 64
	yo=rnd(150) - 75

	x=(xo+32)*st2 - yo*ct4
	y=(xo+32)*ct4 + yo*st2

	c = -st8 * x/16
	+ cos(xo/64 - t/2) * y/32
	+ t
	
	c=flr(c%2)
	c+=fflr(t+1,period/2)
	
	circ(x+64,y+64,1,c)
end

function pattern2()
	xo=rnd(80) - 64
	yo=rnd(150) - 75

	x=(xo+32)*st2 - yo*ct4
	y=(xo+32)*ct4 + yo*st2

	c=sin(xo/64-t/4)+sin(y/64)
	c=c%(t*2) 
	c=c+2*t

	c=flr(c%2)--{0,1}
	c+=fflr(t+1,period/2)--{k,k+1}

	circ(x+64,y+64,1,c)
end

function fflr(a, unit)
	-- slightly wrong
	return a - a%unit
end
__label__
ooo0ooooooooooo2oo2o22222222222222o222222222222222ooooooo22222ooooooo2222oo2oooo2222220722o7707777077077070700700000077777777707
oo0o0ooooo0oooo0o2o2o222222222222222222222222222222ooooo22o2o2ooooo2oo222o2o2ooo222222227027777770777700007777077000077707777700
oo077o0oo0oooooooo2o2o2222222222222222222222222222o2oooo2o2o2o2oooooo2o222o27oo2o22222222272777777077700007777777700700070000700
o777ooo000oooooo0oo2o2o2o22222222722222222222222222o0oo2ooo2222oooo22o222o2oo7ooo22222222027777777777770000777777770000000000000
ooo7ooo0oo0o0oooo0oo2o2o22222227222222222222222222o0oooooo222222o2o2o22022oo7oooooo2222222002o7777777070000777707770000000000000
oooo7o7ooooooooooooooooo222222222222222222222222220ooooooo2o222o222o2ooo2oo2oooooo2o22222202oooo77777700000777770700000000000000
ooooo7ooooooooooo0ooooooo222222222222222222222222220ooooooo2o2o2222oooooo22oooooooooo2222202ooo0o0777777000077770707000000000000
ooooooooooooo00oooooooooo0oo2222222202222222222222o20ooooo2o2722o2ooo2oo2722ooooooooo22220222o2o07077770700707777070770000000000
oooooooooooooo0oooooooooooooo22222222222222222222o2oooooooo2o2222ooooo22o2oo2o2o0oooo22220022202o0770777070070007707777000000000
o0oooooooooooo2ooooooooooooooo22o222222222222222o2o2oooooooo22222ooooooo2oo2o2o7oooo2o222222202o0o007777707000007777777000007007
oo0oooo7ooooo7ooooooooooooooo7ooooo22222222222222o2oooooooooo222o222ooo2o2o22o2oo2o2o0o222222222o0000777070700007777777700777777
oooooooooooooooooooooooooooo7ooooo0o22o222222222oooooooooooooo22222o2ooo2o2o22o2oooo22222222022220000777707000000077777777777777
ooooooooooooooooooooooooooooooooooo2oo2o2o222222oooooooooo2oo222222oooooo2o2222oooooo2o22222222270007777770000000707777777777777
oooooooooooo7oo2ooooooooooooooooooooooo2o2oo2o2oooooooooooo2o222222ooooooo2222ooo2oo2o2o22222220720o0777707070000007777777777777
ooooooo0ooooo2o22ooooooooooooooooooooooooooooooooooooooooooooo22222oooooo2222o202o2oooo22222222222o0oo77777777000070777777777777
oooooooooooooo2ooooo2ooooooooooooooooooooooooooooooooooooooooo22222ooooooo22222o222oooooo2072222222oooo7777777700700777777707777
ooooooooooooooooooo2oooooooooooooooooooo2ooooo2oooooooooooooo222222oooooooo222222222oooo2o2222222272oo77777777007000000777070077
ooo0oooooooooooooo2o7oooooooooooooooooo2o2ooo2oooo7ooooooooo2222222o2ooooooo2222222oooooo222222222222200o77777000000000000700700
o0oo0oooooooooooo2oo22o0ooooooooooooooooooooooooo7ooooooooooo222222222ooooo22222o2o0ooooooo22222222220oo0o7777700000000000007000
2ooooooooooooooo2oo2o2o2o2oooooooooooooooooooooooooooooooo2ooo22o2222ooooooo22222o2ooooooooo222272222o2oo00777770000000700000000
2oooooooooooooo0oooo2o2o2o2ooooooooooooooooooooooooooooooooooo222222oooooooo2o22o2o2ooo7oooo2222222222oo000077700770000707000000
o2oooooooooooooooooo22o2o2oooooooooooooooooooooooooooooooo2oo22222222ooo2oooo2oo222oooooooo72222222222o0oo0077777777000700700000
2oooooooooooooooooo222222ooooooooooooooo7oooooooooooooooooo2o22222222o22ooooooo22222oooooo7o77722222272oooo707777777707070000000
22ooooooooooooooo2222222222ooooooooooooooooooooooooooooooo2o222222o222o2oooo2o22222ooooo7oo2o2222222222oooo070777777770700000000
2222oooooooooooooo22720222222ooooooooooooooooooooooooooooo2222222222222oooo2o2o2222o2ooooo2oooo222222222ooo007070777777070700007
2222ooooooooooooooo22020222222ooooo2ooooooooooooooooooooo222222222222o22oo2ooo222222o2o2ooooooo2222222220o00o0007777777777777770
2222oooooooooooooo2o222222272222oo2o2oooooooooooooooooooo2222222222o222o2oooooo2o222222o2oooooo222222720220o0o007777777777777707
022o2o7oooooooooooo22222222222222222ooo2oooooooo2oooooooo222222222222o22oooooo2o22222222ooooo222222272722220o0007007777777777070
2222227oooooooooooo222222222222222222o2o2oooooo222ooo2oo2o2222222222222ooo0oooooo222222ooooooooo2222222722200o000007777777777777
2222222ooooooooooooo2222222222222222o2o22o2o2o2222oo2o2o22222222222222ooooooooooo222222ooooo7ooo222222222277o7o00007077077777777
222222o2o7ooooooooo2o2222222222222222222o2o2222222ooo2o22222222222222o2oooooo2ooo222o2o2oooooooo222222222220oo000070000007777777
0022222o2oo7oooooooo2o2222222222222222222o222222222ooo22222222222222o2oooooooo2oo22o2o2o2oooooo2o2222222222ooooooo00000007777777
22222222oooooooooooooo222222222222222222222222222222o22o2o222222222222ooooooooo2oo22o222oooooooooo2227222227ooooooo0000007077700
222222222oooooooooooooo222222222222222222222222222222222o22222222222222ooo2ooooo2o2o2o222oooooooooo2222272772oooooo0000070700000
2222222222oooooooooooo22222222222222222222222222o222222o22222222220222ooo2o2ooo2o22222o222ooooooooo2222227227ooo7o7o000007000000
200222222o2ooooooo0ooo0222222222222222222222222o2o2222o2222222222o222oooo2oo22oo222222o2222ooooo2o2oo22202222oooo7o7700000000000
0020220222ooooooooooooo2222222222222222222222222o222222222222222222222ooooooooooo722222o22o2ooooo2oo2o22222222oo7o77700000000000
0022022222o0oo0ooooooooo222222222222222222222222222222222222222222222o2oooooooooo22o222o222o2oooooo2o22222222227o7o7770070000000
02022222222o0ooooooooooo2222222222222222222222222222222222222222222222oooooooooo2oo222222222oonnnooo2222222222777o7o777707000700
o02220222222ooooooooooooo22222222222222222222222222222222222222222o2o22oooooooo2oooo2222222o2nnnnnoo2o222222227727o7o77770707070
o0222220222oooooooooooooooo2222222222222222222222222222o22222222222oooooooooooooooo2222222220nnnnn3oo22222222222227o77o777077707
7o2222222222ooooooooooooooo222222222222222222222222222722222222222ooooooooooooo2ooo22222222o2nnnnn3o2ooo22272222227o7ooo77777777
o772222222202oooooooooooooo2222222222222222222222222222222222222222ooooooooooo2o2o2222222222o3nnn3ooooo2o022222222o2oooo7o777777
777722222272oooooooooooooooo2222222222222222222222222222222222222o2oooooooooooooo2o22222222o2o33o3oooooo22222222222oooooo7o77777
7777222227222ooo7oooooooooo72222222222222222222222222222222222o2ooo2oooooooooooooo2222222222o2ooooooooo2o22222222222oooooo777777
777772227722222oo7ooooooooo2o22222222222222222222222222222222o2ooooooooooooooo2ooo222222222j2o33oooooooo222222222220oooo00o00777
777o7727722222ooooooooooooooo222222222222222222222222222222222o2ooooooooooooooooooo222222222ojoooooooooo2222222222020oo0oo0o0007
77o7o2722222727ooooo7ooooooooo222222222222222222222222222222o22ooooooooooooooooooo22222222222ooooooooooo2222222222222o0oo0o00000
777o22272222722oooooo7ooooooooo2222222222222222222222222222o2ooooooooooooooooooo22222222s222o2oooooooooo22222222222222oo0o070000
7777222277222727oooooooooooooo2222222222222222222222222222o2o2ooooooooooooooooooo222222222222o2oooooooooo2227222222222o0o00o0000
77777227272222227oooooooooooooo2222222222222222222222222222o22ooooooooooooooooooo2222222222222ooooooooooo72727222222202o0oo0o000
77777772727222222ooooooooooooo0o22222222222222222222222222o2oooooooooooooooooooo222222222222oooooooooooooo022272222222o2oo0o0000
0770777027772222oooooooooooooooo2222222222222222222222o2222o22oooooooooooooooooo22222222222o2ooooooooooooo2222222222222oo2oo0000
70070002072720222oooooooooooooooo22222222222222222222o2o2ooooo2oooooooooooooooo2222222122222o2ooooooooooo2o222222272222o2oooo7o0
00000020220272222o2oooooooooooooo222222222222222222222o2o2ooooooooooooooooooooo22222222222222ooooooooooooo22222227222222oooooooo
000000022020222222ooooooooooooooo2222222222222222222222o2o2oooooooooooooooo22222222222222222o2oooooo0ooooo202222227222222ooo7ooo
00000000020000222222oooooooooo0ooo2222222222222222222222oooooooooooooooooo2222222222222222222oooooooooooooo222222222222222ooooo7
000000000000002222202oooooooooo7ooo22222222222222222222oooooooooooooooooooo222222222222222222ooooooooooooooo22222222222222ooooo7
00000000000000020202oooo0ooooooo7oo222222222222222222222oo2ooooooooooooooooo2222222222222222ooooooooooooooooo2222202222227oo7o7o
00000000000020000022ooo0oooooooooooo2222222222222222222oooooooooooooooooooo2o2222222222222222ooooooooooooooooo22222222222027o77o
000000000002022000272o00ooo7ooooooooo222222222222222222ooooooooooooooooooo2o2222222222222222oooooooooooooooo7o7022222022222o7oo0
00000000000022720072oo7ooooooooooooooo222222222222222222ooooooooooooooooooo22222222222222222oooooooooooooooo2202222222022222o2oo
7070000000077727277oooo7ooo7ooooooooo722222222222222222ooooooooooooooooooo2222222222222222o2ooooooooooooooo2o22o222222002222oo2o
77070077077777727272oo7oooooooooooooo2o222222222222222o2ooooooooooooooooooo22222222222222o2ooooooooooooooooo22o222222222022ooo0o
7770777777777777272o2oo7oooooooooooooo22222222222222222oooooooooooooooooooo222222222222222ooooooooooooooooooo72222222222202ooooo
77777777777777777772oooo7ooooooooooooo22222222222222222oooooooooooooooooooo2222222222222222ooooooooooooooooooo22222222222222oooo
777777777777777777272o7ooooo7oooooooooo22222222222222222oooooooooooooooooo2222222222222222o22oooooooooooo22oo2o22222222222222ooo
7777777777777777777227oooooooooooooooooo2222222222222222ooooooooooooooooo222222222222222oooooooooooooooo2222oo2722222222202222oo
77777777777777770772727oooooooooooooooo222222222222222222oooooooooooooooo22222222222222oooooooooooooooooo22oo7o2o2222222022272o2
777777777077777070272o7o0o0ooooooooooooo22222222222222222o2oooooooooooooo22222222222222oooooooo0oooooooooo22o2oo2o22222222227o2o
07777777770777000702o0o0o0oooooooooooooooo2222222222222222ooooooooooooooo2222222222222o2oooooo2oooooooo2o2222o22222222222222oooo
707777777070700000000o0o0o0oooooooooooooooo222222222222222oooooooooooooo222222222222222ooooooooooooooo2o222222o2222222222227oooo
0007000700000000000000oo0oooooo0oooooooooooo222222222222222oooooooooooooo22222222222222oooooo2ooooooooo222222ooo22o2o22222227ooo
700000000000000000000oooooo0o00oooooooooooo2o22222222222222ooooooooooooo2222222222222o2oooooooooooooooo2ooo22o2o2o2222222222272o
7000000000000000000000oooooooooooooooooooooo22222222222222o2oooooooooooo222222222222o2o2ooooooooooooooooo22222o2o2222222222222o2
0000000000000000000000000ooooooooooooooooooo222222222222222o2o2oooooooooo222222222222ooooooooooooooo2o222o222o22272222222222222o
000000000000000000000070o0ooooooooooooooooo2o2o2222222222222ooooooooooooo222222222222oooooooooooooooo2222222o22o2o222222222222oo
0000000000000070070077777oo7oooooooooooooooo2o222222222222222oooooooooooo2222222222222oooooooooo2oooo22222222o0222222222222o2ooo
0000700007700777777777777o7o7o7oooooooooooooo2o222227222222222ooooooooooo2222222222222oooooooooooooo2o22o22222o22222222222o2oooo
00070070707777777777777777o7oooooooooooooooooo22222722222222222oooooooooo222222222222oooooooooooooo2o22o2222222222o22222222o22o2
007777777777777777777777777oo7ooo7oooooooooooo2222o27222222222ooooooooooo22222222222o2oooooooooooo2o2o222222222222222222022202o2
77777777777777777777777777777o7o7ooooooooooooo2222222722222222oooooooooo2oo2222222222oooooooooooooo2222222oo22222222222222oo2o2o
77777777777777777777777777777o77o77oooooooooooo22222222222222o2ooooooooooooo222222222ooooooooo2ooooo2222222222o2o222o22oooooo2oo
7777777777777777777777777777o0o7n77o7oooooooooooo2222222222222o2ooooooooooo222222222o2oo2oooooooo2oo222222o2222o222ooooooooo22oo
70777777777777777777777707770o0o7ooooo7oooooooooooo222222222222ooooooooooo22222222222oo2oooooooo2o22o2222222222222ooooooo22222oo
007777777707777700707070707700o0ooooo7oooooooooooo22222222222222ooooooooooo222222222ooooooooooooo2o222222222222222ooo2ooo2ooo22o
000707777070007070070000000000000ooooo7ooooooooooo22222222222222oooooooooooo22222222oooooooooooooo2o222222222222o22o222o2oooo2o2
0000000707000007000000000000000000oo00oooooooooooo22222222222222oooooooooooo222222222oooooooooooooo22222222o222222o22oo2o2oo7o2o
0000007070000000000000000000000000o70oooooooooooooo22222222222222ooooooooooo22222222o2ooooooooooo2222222222222222o2oo2oo2o2o22o2
000000070000000000000000000000000o0o70oooooooooooo2o22222222222222ooooooo2ooo222222o2oooooooooo222222222222222222ooo2ooo22o2oo2o
0700070000000000000000000000000000o7o00oooooo7oooo22222222222222222oooooooooo22222o222oooooooooo2222222222222227oooooooooo7o2oo2
77707000000000000000000000000000000o0oooooooooooo22222222222222222222oooooooo2222222222oooooooooo222222222222o222ooo2oooo7oooooo
777777700000000000000000007000000000oooooooooooo2o22o222222222222222oooooo2o2o2222222222ooooooo2222222222222o2o22ooooooooooooooo
777777777770777000700000070700000000ooooooo2oo7222oo222222222222222oooooooo2o2o22222o2222ooo2o222222222222222o22oooo2oooooooooo2
7777777777777777777707007070000000000oo0oo2o2222222o22222222222222222ooooooo2o2222222222ooooo2o22222222202222oooo2ooooooooo2oo22
7777777777777777777777770777770070000000ooo22o2222o2o2o222222222222222oooooooo202222222oooooooo2o22222222222oooo2o2o2ooooooo2ooo
77777777777777777777777777777777070707070oooo20o2o2o2o2o22222222222222ooooooooo2222222oooooooo2o22222222222o2oo2ooo2o2oooooooooo
77777777777777777777777777777777777770707220o0o0oo2oo2222222222222222o2ooooooooo222222ooooooooo22222222222o2oo2oooooooooo2oooooo
070077777777777777777777777777777777770722222oo2o2o2o222222222222222222oooooooo2o222222oo2ooooooo2222222222oo2o2ooooooooooooooo2
00000777777777777777777777777777777770070222o22o2o2ooo2202oo222222222222oooooooo222222222o2ooooooo22222222222o2oooooo22oooooooo2
000000077777777777777777777777777770777070022oo2o2o2o2oo22o22222222222222oooooo22222222222o2ooo2oo22222222220oooooooo2ooo2oooo2o
00000000777777707777777777777777777777770727222o2o222o2o2o2222222222222222ooooooo2222222222ooo22ooo22222222ooooooooo2ooo2o2oooo2
000000000707777777777077777777770777777077722222222222o2o2222222222222222oooooooooo22222222ooooooooo22222222ooooooooooooo2o2oo22
00000000007077777777070070777777777777707770722222o2222o2oo222o2272222222ooooooooo2o2222o2oooooooooo2222222ooooooooooooooo2oo2o2
0000000000077777777700700777707777777777070702222o2o2222oo2o2222722222222ooooooo2oo22222o2ooooooooo222222o2oooooooooooooo2o2222o
7000000000070077777770000777070777777707777022222202o222o2o2222222222222222oooo2ooo2222o222o0oooooooo22222oooooooo2ooooooo222222
070000000000070777770000007000007077777077777222022722222o2o22222222222222222ooooooo222222222ooooooo2o2222o7oooooooooooooooo2222
7777700000000077777770070770000007777777777777272222222222o2o22o22222222222222ooooooo222o222222oooo2o222222o0ooooooooo2o22ooo222
77777077000000777777770070070000007777777777777222222222222722o2o22222222222222ooooooo222o2222o2ooooo22222o2o7o2ooooooo2222ooo22
777777777000007777777770000070000707777777777777722222222222222o222222222222222oooooo2220o2o2o2ooooo2o222o2o2o2oooooooo0227oooo2
7777777700000700077700000007000070707707777777777222222o22222222222222222222o2ooooooo22022o222oooo2oo2o2o2o2o2o2oooooooo2oo2oo27
7777777770007000077770700000700007770777777777770222222222222222222o202222220ooooooo0o022222222o2oo0oo2o2o2ooooooooooo22222o2222
77777777770007000077777770000700007777707777707777227222222222222222o202222222ooooooooo022o222o2o02o22oo2oo2ooooooooo2o22222o222
7777777777000000077777777700700007007007077707777777222222222222222227222222222ooooooooo2o2o222o2oo2o222oo2o2oooooooo02o22227o22
70777777070700007777777770000000000700707777777777722222222222222o2oo2222222222oooooooo2o2o22222oo2ooo2o2722ooooooooo222o2222222
07007777777000000777777770000000007000077077777777722222222222222ooo222222222222oooooooo2oo2o22222o2ooo222o22ooooooo2o2222222222
000007777770000007777777700000000000007700777777777722222222222222o2o222222222222ooooooooooo2o222o2ooo22222222ooooooo222oo222222
00000777770700707077777777707000007007700007777777777227222222222o2o22222202222222ooooooooo222o2oooooooo222222o2ooooo22o2oo72222
0000070777707007070777777777000007007770007777777777777272222222o222222222222222222ooooooo2222222ooo2oo2o222222o2ooooo222o272222
000000707777700000707777777077077700077707777777777777772oo222202222222222222222222ooooooo2oo22222o2o20o22222222oooooo7272o27222
00000007777777000007777777777777700070777777777777777777oooo2022272222222222222222oo222oooooo2222ooo2o2oo222222o2ooooooo222o2222
000000007707700000007777777777770000070007777707777777777oo2220272722222222222222222222ooooooo272o2ooooooo2222o2o2ooooo222222222
0000000077777000000777777777777770000000007070707777777777222222270o22222222222222o222oooo2oo2o22222222ooooo2ooo2o7o7o2222222220
0070000070777700000777777777777770000000070707070777777777722o22o2o2o222222222222222o2ooooo0oo2o2222222oooo2o22o77o7222222222222
770707000707700000007777777777777700000070007777707777770700o2oo2o2o2o2oo0o2222222222ooooooo22o2oo2o2ooooo2o22o2oo72772222222202
7770000070077770000077777777777777700000700077777770707000000o02o2o2o2o2222o222022222oooooooo2oo2oooooo2222o222oooo2277222220027
777700000000777700000777777777777777000000007777077700000000022o2o2o2o22222222220222o202oooooo2o22ooo22222o2o2oooo2222272722200o
77700000000777777000007777777777770000000000077000000000070022o2o222o22222222222202o2o222ooo2oo227oooo2o22oo272oo2222o7272222277

