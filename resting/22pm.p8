pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
function sqr(a) return a*a end
function dist(x1,y1,x2,y2) return sqrt(sqr(x2-x1)+sqr(y2-y1)) end
function show_cpu(c1,c2) cp=flr(stat(1)*100) rectfill(0,0,12+4*#(tostr(cp)),6,c2) print("∧"..cp.."%",1,1,c1) end
function nsin(a) return (sin(a)+1)/2 end
function ncos(a) return (cos(a)+1)/2 end
function tan(a) return sin(a)/cos(a) end
function drw_mouse(x,y) spr(0,x,y) end

pal(13,13+128,1)

function get_oxy()
	ox=rnd(128+bk)-8
	oy=rnd(128+bk)-8
	local ch = rnd(1)
	if ch<0.05 then
		ox-=1
	elseif ch<0.1 then
		ox+=1
	end
	return ox,oy
end

poke(0x5f2d, 1)--enable mouse
p={}
for i=1,#p do
	if p[i]~='' then
		pal(i,p[i],1)
	end
end

fills={
	0b1111111111111111,
	0b1111101111011111,
	0b0111111011111111,
	0b0111101111011011,
	0b1110101111010111,--tacks
	0b0111101011010101,--fishbone
	0b1100001101000011,--longboard
	0b1000001010000010,
	0b0000000000000001,
	0b0000000000000000,
	0b0000000000000000,
	0b0000000000000000,
	0b0000000000000000,
}

░=500
dt=0.0333
t=0
bk=8

cls()
rectfill(0,0,128,128,7)

::♥::
--cls()
t+=dt
--mx,my=stat(32),stat(33)

for i=1,750 do
	x,y=flr(rnd(128)),flr(rnd(128))
	ss=sget(x-1,y-1)
	d=dist(x,y,128,128)
	if d>128+28 then
		if rnd(1)<1 then
			sset(x,y,1)
		end
	elseif ss>0  then
		k=rnd(1)<0.12 and 1 or 0
		sset(x+1,y,(ss+k-1)%15+1)
		sset(x-1,y,ss)
		sset(x,y+1,(ss+k-1)%15+1)
		sset(x,y-1,ss)
		sset(x+2,y+2,(ss+2*k-1)%15+1)
	end
end

for i=1,10+sin(t/16)*15 do
	ox,oy=get_oxy()
	for y=oy,oy+bk-1 do
		for x=ox,ox+bk-1 do
			ss=sget(x,y)
			fillp(0b1111111111111111
				-fills[flr(ss%#fills+1)])
			pset(x,y,7)
		end
	end
end

-- for i=1,250 do
-- 	x,y=rnd(128),rnd(128)
-- 	w=1
-- 	sum=0
-- 	ct=sqr(w*2+1)
-- 	for xa=x-w,x+w do
-- 		for ya=y-w,y+w do
-- 			sum+=sget(xa,ya)			
-- 		end
-- 	end
-- 	ss=ceil(sum/ct)
	
-- 	--ss=sget(x,y)
-- 	--ss=x/16+y/16
	
-- 	fillp(0b1111111111111111
-- 							-fills[flr(ss%#fills+1)])
-- 	circ(x,y,1,7)
-- end

--sspr(0,0,128,128)

--drw_mouse(mx-1,my-1)
flip() goto ♥
__label__
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
70777077707770777077707770777077707770777077707770707070777777777777777777777777777777777777777777777777777777777777777777777777
77077707770777077707770777077707770777077707770777777707777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777770777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777077777777777777777777777777777777777777777777777777777777777777777777777
70777077707770777077707770777077707770777077707770707070777770777077777777777777777777777777777777777777777777777777777777777777
77077707770777077707770777077707770777077707770777077777770777077707777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777770777777777777777777777777777777777770777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777770777777777777777777707770777777707777777777777777777777777777777777777777777777777777777
70777077707770777077707770777070707770707777777770707777777770777077777777707777777777777777777777777777777777777777777777777777
77077707770777077707770777077777770777077707770777077707777777077707770777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777077777777777777777770777777707777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777707777777777777770777777777777777777777777777777777777777777777777777
70777077707770777077707777707077707770777777707770777077707077777777707770777770777777777777777777777777777777777777777777777777
77077707770777077707770777777707770777077777770777077707770777077777770777077777770777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777770770777777777777777777777777777777777777777777777777777
77777777777777777777777777777777077707770777777777777777777777770770077777770770077707777777777777777777777777777777777777777777
70777077707770777077707770777077707777707777707077777077707770777777707777707770707077777777777777777777777777777777777777777777
77077707770777077707770777077707770777777777770777077707770777077707770777077777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777770770777777777770777777777770777777707070777777777777777777777777777777777777777
77777777777777777777777777777777777777770777077707707777777707770777777707700777077707770777777777777777777777777777777777777777
70777077707770777077707077777077777070777770777770707077777070777077707770777070777770707070777777777777777777777777777777777777
77077707770777077707770777077707777777077777770777777777777770077707777777077707770777777707777777777777777777777777777777777777
77777777777777777777777777777777777777777777707777777077777707777077777700777777777777770707777777777777777777777777777777777777
77777777777777777777777707777777077707770777777007777770777770000770077707777777077707770777077777777777777777777777777777777777
70777077707770777077707070777070777077777077777070777077707700707077707770707077707070770077707070777777777777777777777777777777
77077707770777077707770777077707770777077777777777077707777000077007770777077707770777077777770777077777777777777777777777777777
77777777777777777777707777777777777777777777777777777777707700770077707777777777777777770707770707070777777777777777777777777777
77777777777707770777777707777777777707777777077707777770077007777700077777770770777777770777777707777700777777777777777777777777
70777077707070707077707777777777707070707070777770777770777070777070707070777070707770777070707077707070707707777777777777777777
77077707770777077777770777077707770777777707770777077777770777077770770707077777770777777777770707077007770007777777777777777777
77777777777777777777077777777777707777777777707707777777777777777077777700777777007777777777770707070707077707777777777777777777
77777777777777777777077777770777077707770777077707777777777777770777007777707777777007770770777707000707077777077777777777777777
70777077707777777070707070777070707770777070707777777770707770777070777777777077707070777777707070777077007000770777777777777777
77077707770777777707777777077707777777077777770777777777770777077707777777770707770777777777770777000707070077000707777777777777
77777777777777777777777777777777777777777777007770770077077777770077777777770077777777770777077777770007070707770077777777777777
77777777777777777777777707777777777707777777777707707777777777770777077707707700777777707777077007777700707077007707777777777777
70777070707770777770777070707070707077707077707770777077707770777077707077777070007770707077707770777077007000770077077777777777
77777707770777777777770777777707770777777707770777077707777777077707770777077707770777007707770777077700700070000700707777777777
77777777777777777777707770770777077770777777077707077707777707777777077707777777777707770777077770777070007000770077007777777777
77777777777777777777777777777770777777770770777777777777077777700777077707777777777707007770007707707700700070007000770777777777
70707077777777777077777070777077707070777077707770707077777070777077707770777077707007777077007770707070007000700077007700777777
77777707777777077707777777077707770777077707770777077707770777077707770777077707777777077007770777770707700070000000000070077777
77777077707777777077777777777777777770770777777777077777700707770077777777070777777770707077777777700777007000700077007000707777
77770777777777770777077707770777077707707770777707770777077777707077077777070777777707770077777707000770700000707700070070007777
70777777707770707070707770707770777077777077777070707077707070770770777770770070777070700070007770700070007000700070007000700777
77077707770777077707777777077777770777077707777777077707700077070707770777077707777777777000000770000000700000000007770000007077
77777077777700777777777777777777777777770777077777777707077707700077707777777777077777777077000777770007000000700707070700000007
77777777777077770777077707770777077707707777077777777777070777077770077077770770077707770700700077007000000000000007077070000000
70707070707770777077777770707070777077777077007077707770707770777070707770777070707077707777007000770000007000000070007700700000
77077707770777077707770777777707777777777707770777777707770777777700070777077707770777077707770077000000700070000707770007000000
77777777777707770777777707077777777777777777077707777077777777770770077770770777077777770777007000770007007000770007070700070077
77777777777707777777777707777777777707707700777077700777077777077770777707777777777707770777077707070707007070000000070700007700
70777777777770777077007077707077777770707077707770777770777070777077007070777770707770707070777007707070000700700000007700770000
77077707770777077707070777777707777777077707770777007707777777007707770077777707777777077777770707777070070070007000070000770000
77777777777777777777707777777077707777777777777707770077777777770707077707777777777777070707707777777077700000700000007707700000
77777777777777777777077707770777077777707777777077707777077707707770077707770777077707770777077707770777770000007000000777700000
77777070707770777077707070777070707770777777707770777070777077707070707770707077777070707070777077707077777000000070007070700000
77077777777777077707770777077777770777077777770777077707770777777707770777070777777777777707707070007707707707000000000000077000
77777777777770777777777777777077777777770777070770777777077777777777700707070707777770770777077707777077707770070077007700070000
77770777077777770777077707770777077707770770077707707770077707770770770707770777700707777770000007000777077700700000700000007000
77777077777770777070707770707077777770707777707770777077707000707777707700770077707077707077000070700070007700700000007700000000
77077707770777077707770777077707770777077777770777077707770007077777770777070707700777777777700070077000700007000000000000007000
77777777777777777777707770777077777707777777707700770777707707777777707770770707070707770777000000770770007000007007007700700007
77777777777707777777777707777777077707770777077777707777777077770777777077077770077707777770070770007070700070000000000000000000
77777070707070777070777770777070777070777777777770770077707770777070707770770077707070707077700707070077700000700000000000000070
77777707770777777777777777077777777777077777770777007707770777077707770777077700770777007777770007007007000070000000700000000000
77777777777777777777777777777077707777777777777777770007777707777777777707770070000707070777777000000007000007700000000700700000
77777777777707777777777707770777077777770777077707770777077707777777077777707770007777070777070000000000700070000000700000000000
77777777707070707077707070777077707000777077707077777070707770777077707777707070700070707077777000000077000000700070000000000000
77777707777777077707770777077707770777777707770777070700770777077707770777077700770707077707770700070007770007077000700770007000
77777777777770777777707770770077007770777077707770770007777777777007077707770770070707770007070707007077700007770070000700770000
77777777777707777777777777770770777707770777077777707770777707770707770777707770777007707777070000777777707000700000000700000000
77777777707070707770777777707077707770707777707770777077707070707077777770770077707770777070707700707070707700777070000000000070
77777777770777777777777777777707770777077707770777077700770777077707770777000700777777077707070007077707700000070707700070007000
77777777777777777777777770777077700707770077707707777770077700777077777777070077707007070777007000770707070700000007000000770070
77777777777777770777077707777777077077700777077707707770007007770777077777777770777077777770077000007777070700000077000000000000
77777777707070777077777070777077707770707077707070777077707070777077707770777077707000770070707700700070007070000007700000000007
77777777770777077707770777077707770777077707770777077707770777077707770777777700077007000007700077000700070077000007070070000000
77777777777777777077707777770777707700770777770077770777770700770777777707777707007770070077070700700007077700070007000700070000
77777777777707770777777707770770077707770777777707770777077707770777077077770777777007007000777077700000777777700000000000000000
77777777707777777077707077707070707770777077707700707077777070707077707770777070707000770070007070777000007700700000700000000000
77777777770777077707770777777777770777077707070777077707777770077707770777077700770770007700770777007000070077070000070070077000
77777777777777777777777777777777777777770077707777070777777770770707777777777770077700700077007707770700007707070007000700700070
77777777777777777770077777770777077007707777070777000770077707770700077707770777777770007700700707707770070077770700000007000000
77777777777770777077707770777770707770777077707700770070707770707070007770770777707070700077000000777077007770777070000000700000
77777777777777077707770777077777770777077707770707000700077777077700770777077777070707007000000007077707070000077700000000000000
77777777777777777077707777777077077700777777707770770077007707770777000700770077707700770077007700770777007700070077000700070007
77777777777777770777077077777777077707777777077707707700770007070777077707777770077000707700700000770770700000707770770000000000
77777777777777777070707770777077777070777070707770777077707700707077700070770077707000700070007000000070000000070000707700070070
77777777777777777707770777077707777777077707770777007700770070007707770007070707770707000000700000077700700000000000770070000000
77777777777777777777777777777777707777770777777770770077070000770077007700770707070770070000007700070777700700070007707707070000
77777777777777777777077007770777077707777777077707077770770777000707770000777007077777000000000000007770700000007707077077007000
77777777777777777777707000707777707777707077707070777077007700770000707000070077707770770000000070000077707000070077707770777000
77777777777777777777770707070077770777777707770770077707770070000000770000007700770777000700000000007707770700000700770777077700
77777777777777777777777700070007707770770777007707070777007700700007070700000070070700770077000070770007007707000070007777770700
77777777777777777777777777070070077707777770077777770770770007700000077000700700077700000770770000707707077077700000000707777700
77777777777777777777777770777000777077777077707770707077707700000077007000707070000000000077707070700077000070700000000070707077
77777777777777777777770777077707077777077707770777077707770000077000700700070000770700000007070007077000700000077000000070070000
77777777777777777777777770077777077770777777077707777777707700070007000000000700000700000007070700070007007000770000000000070007
77777777777777777777777707777770777707770777777707777770770777000000007007000000000070000000007000770700007000770000000070000000
77777777777777777777777770777077707070707070777770000077707700700000007700700000000000000000007070077007007000070070000000007000
77777777777777777777777777070700770777777707770777007707770777000000000007000000000007000000000707077700770000070000000007070000
77777777777777777777777777770777007777777077070777770007707707770077000000700000000000770000000007077077000707070077000000777007
77777777777777777777777777777700707707777777077707770700077077077707000070007000000000707700000007777700077070007000000000777770
77777777777777777777777777777070007707777070777777007077707070777070700000707000000000077077007000000077707000700077000000077707
77777777777777777777777777077707700007077777770777077700070777077707770777000000070000077000070700000000700000000000770070000770
77777777777777777777777777777707777777770707070777777777007777770777770700070000070070070077007000000000007000000077000700000000
77777777777777777777777777777700077777070777077707770777000777700777077707700000077700070070000077070700000000000000000077000000
77777777777777777777777777777777007770707077707700007770707070777077707070700000707770000007007000700000700000000000000000000000
77777777777777777777777777777770077777007007770770000707770770070707770077007700000707000000770007007707770000000007000007000000
77777777777777777777777777777777707777700077007707007777777700770077007707770070000000700007007007700777070700000000000000000000
77777777777777777777777777777777077707007000077007770070077707777700077007707700000000777070070070000770007770000007000000000000
77777777777777777777777777777777777077700007007770777770707770777077000700000077000000770000007700000077707070000000007000700000
77777777777777777777777777777777777777777777770077077777770777007777070700000700000000077707070777000007770070007000070000000000
77777777777777777777777777777777777777770770077707070777777707070707000707000070000700777770007770770777077000700077000700000007
77777777777777777777777777777777777707770770700007777707077007770777000000700000700077007770007707777700777077007700770007007000
77777777777777777777777777777777777770777777007070777770777070707077777000700000007700770070000770777077707770700077007000000000
77777777777777777777777777777777777777077777700077077777770777077777777077000000000007000707000007077007770777000000070000007000
77777777777777777777777777777777777770777077707007777707777070770777770000700000007000700007770000777007007707700007007700070077
77777777777777777777777777777777777707770777077077700777770070707700770070000000070070000007077000777700777777007000770070007700
77777777777777777777777777777777777770777770777770777077707000770077707000070000007000000007700070770070707070770007007700007000
77777777777777777777777777777777777777777777770777077707770770000700770700000000000000000700770700077707770700000700700007000700
77777777777777777777777777777777777777777777777707770077070700770007007707777000007000707000077700770070007700070777000700770070
77777777777777777777777777777777777777777777077077707777077007700000070077077077000070000007007707770000770000777770700077000700
77777777777777777777777777777777777777777770777770770077007077700070007070770070007000000000000070777077707700707777707700770007
77777777777777777777777777777777777777777777777777077700070070707000070777000777070000007707000777070000070000007007770070000000
77777777777777777777777777777777777777777777777777777707007700770077007777700777070000000070007000070777007000070007070700070007

